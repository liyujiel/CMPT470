"use strict";angular.module("weatherApp.widget",["weatherApp.core","ui.router","LocalStorageModule","pascalprecht.translate"]),angular.module("weatherApp.widget").constant("ME","widget").config(["$httpProvider",function(a){a.interceptors.push("RequestInterceptor")}]).config(["localStorageServiceProvider",function(a){a.setPrefix("wa").setStorageType("sessionStorage")}]).config(["$translateProvider",function(a){a.useStaticFilesLoader({prefix:"/translations/",suffix:".json"}),a.preferredLanguage("en").fallbackLanguage("en")}]).filter("epochToFullDate",function(){return function(a,b,c,d){var e,f=new Date(0);if(f.setUTCSeconds(a),e=f.toString().split(" "),e[2]="0"==e[2][0]?e[2][1]:e[2],"En"==d)return b+", "+c+" "+e[2]+", "+e[3];if(["Da","De","Es","Fr","It","Nl","No","Pl","Sv","Tr","Ru"].indexOf(d)!=-1)return b+", "+e[2]+" "+c+" "+e[3];if("Pt"==d)return b+", "+e[2]+" de "+c+" de "+e[3];if("Ja"==d)return e[3]+"年 "+c+" "+e[2]+"日 "+b;if("Ko"==d){var g=new Date,h=g.getMonth()+1;return e[3]+"년 "+h+"월 "+e[2]+"일 ("+b+")"}return e[2]+", "+e[3]}}).filter("detailsFormat",function(){return function(a,b){return a=a.toFixed(1),["En","Ja","Ko","Hi"].indexOf(b)!=-1?a:(a=a.toString(),a.indexOf(".")>-1?a.replace(".",","):a)}}),angular.module("weatherApp.widget").run(["$rootScope","$state","BrowserDetection",function(a,b,c){a.browser=c.getClientBrowser(),a.$on("$stateChangeError",function(a,c,d,e,f,g){angular.isObject(g)&&angular.isString(g.state)&&b.go(g.state)})}]),function(){angular.module("weatherApp.widget").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){b.otherwise("/"),c.html5Mode(!1),a.state("widget",{url:"/",templateUrl:"views/widget.html",controller:"LayoutCtrl",controllerAs:"LC",resolve:{resolveData:["$q","SettingsService","WeatherService","$translate","WixService",function(a,b,c,d,e){var f=a.defer();return b.get().then(function(a){var g=e.getLocale();a.language=a.language?a.language:g[0].toUpperCase()+g[1].toLowerCase();var h="Hi"==a.language?"en":a.language.toLowerCase();try{d.use(h)}catch(i){d.use("en")}""==a.tempUnit&&"En"==a.language?a.tempUnit="f":""==a.tempUnit&&(a.tempUnit="c");var j=a.location.geocode.latitude+"/"+a.location.geocode.longitude;c.get(j,a.language).then(function(c){e.applicationLoadingStep(1),b.put(a).then(function(){f.resolve({settings:a,weather:c})})}).catch(function(a){"site"!==e.getViewMode()?f.reject({state:"editordown"}):f.reject({state:"sitedown"})})},function(a){"site"!==e.getViewMode()?f.reject({state:"editordown"}):f.reject({state:"sitedown"})}),f.promise}]}}).state("editordown",{url:"/editordown",templateUrl:"views/error/error.html"}).state("sitedown",{url:"/sitedown",templateUrl:"views/error/empty.html"})}])}(),function(){function a(a,b){function c(a,b){d(a),_.isEmpty(l)&&angular.copy(b,l),j(b,a.config.data),e(b)}function d(a){if(!a.config)throw new ReferenceError(k+"validateDemoModeArguments: config object must be provided");if(!angular.isObject(a.config))throw new TypeError(k+"validateDemoModeArguments: config's must be an object.");if(!a.config.data)throw new ReferenceError(k+"validateDemoModeArguments: oConfig must have a data property.")}function e(b){m&&a.cancel(m),m=a(function(){_.extend(b,l),l={},m=null},n)}function f(b){m&&a.cancel(m),_.extend(b,l),l={},m=null}function g(a,b){return Math.floor(Math.random()*(b-a+1))+a}function h(a,b,c){function d(a,d){var f="high"===a?b:b-e,h="high"===a?b+e:b,i="high"===a?c:c-e,j="high"===a?c+e:c;d.c=g(f,h),d.f=g(i,j)}var e=5;a.forEach(function(a){d("high",a.high),d("low",a.low)})}function i(a){var b=["clear","cloudy","fog","rain","sleet","snow","storm"];a.forEach(function(a){var c=b[g(0,b.length-1)];a.icon.day=c,a.icon.night=c})}function j(a,c){a.condition=b("translate")("general.condition."+c.key),a.temp_c=c.temp.temp_c,a.temp_f=c.temp.temp_f,a.dayTime=c.dayTime,a.mapping=c.mapping,h(a.forecast,parseInt(a.temp_c),parseInt(a.temp_f)),i(a.forecast)}var k="DemoMode Service: ",l={},m=null,n=1e4;return{applyDemo:c,cancelDemo:f}}angular.module("weatherApp.widget").factory("DemoModeService",["$timeout","$filter",a])}(),function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(a){return e.getSelectedSetOpacity(a).then(function(a){J.opacity=a})}function s(){var a=0,b=[];return p.all([e.getSelectedSetColor(J.settingsModel.design.color.selection),e.getSelectedSetOpacity(J.settingsModel.design.color.selection)]).then(function(c){for(var d=c[0],e=c[1]||1;a<7;)b.push(m.buildForecastBg(d,e,J.settingsModel.design.color.selection,a)),a++;return b})}function t(){var a="websiteColorOpacity";return e.getStyleParams().then(function(b){if(b=b.colors[a],!b)return e.getDefaultColor(a)})}function u(a){b.$apply(function(){switch(a.config.type){case"1":if(x(a,J.settingsModel),y(a.data.location.geocode)||z(a.data.language)){var b=a.data.location.geocode.latitude+"/"+a.data.location.geocode.longitude;return g.get(b,a.data.language).then(function(b){try{n.use(a.data.language.toLowerCase())}catch(c){n.use("en")}J.settingsModel=a.data,J.weatherData=b,J.assets=I(J.settingsModel)})}J.settingsModel=a.data,J.assets=I(J.settingsModel);break;case"2":k.applyDemo(a,J.weatherData);break;case"3":break;case"4":k.cancelDemo(J.weatherData)}r(J.settingsModel.design.color.selection),t().then(function(a){J.customBackground=a}),s().then(function(a){J.forecastBgValues=a}),w()})}function v(c){b.$apply(function(){switch(J.viewMode=e.getViewMode(),J.isFallbackApplied=F(),c.editMode){case i.EDITOR_MODE:J.settingsModel.isPremium||(J.settingsModel.design.animation=J.oldDesign.tmpAnimation,J.oldDesign={tmpAnimation:0},a.$broadcast(h.premium_notification_hide));break;case i.PREVIEW_MODE:J.isFallbackApplied&&(E(),0==J.oldDesign.tmpAnimation||J.settingsModel.isPremium||(a.showNotificationPremium=!0)),k.cancelDemo(J.weatherData)}})}function w(){e.getViewMode();J.showNotification=!J.settingsModel.isPremium&&j.isPremiumItemsSelected(J.settingsModel,J.settingsModel)}function x(b,c){e.getViewMode()===i.EDITOR_MODE&&j.isPremiumItemsSelected(b,c)&&!J.settingsModel.isPremium?a.$broadcast(h.premium_notification_show):a.$broadcast(h.premium_notification_hide)}function y(a){return J.settingsModel.location.geocode!==a}function z(a){return J.settingsModel.language!==a}function A(a){switch(a){case 0:return"none";case 1:return"beach";case 2:return"urban";case 3:return"country";default:return"none"}}function B(a){var b={wixlabs_string_1:J.settingsModel.daysForecast,wixlabs_string_2:J.settingsModel.language,wixlabs_string_3:A(J.settingsModel.design.backgroundSet),wixlabs_string_4:0==J.settingsModel.design.iconSet?"none":J.settingsModel.design.iconSet,wixlabs_string_5:1==J.settingsModel.design.animation?"yes":"no",wixlabs_bool_1:J.settingsModel.location.locationWidget!=J.settingsModel.location.fullAddress,wixlabs_bool_2:"c"==J.settingsModel.tempUnit,wixlabs_bool_3:J.settingsModel.showTempUnitSelector,wixlabs_bool_4:J.settingsModel.showDetailedInformation,event_trigger:a,evid:204};return b}function C(){return q.delete()}function D(){e.addEventListener(h.setting_update,J.delegates.settingUpdateHandler),e.addEventListener(h.edit_mode_change,J.delegates.editorModeChange),e.addEventListener(h.component_deleted,C),e.addEventListener(h.site_saved,function(){f.triggerEvent(B("save"))}),e.addEventListener(h.site_published,function(){f.triggerEvent(B("publish"))}),b.$watch(function(){return J.settingsModel.design.backgroundSet},function(a,b){0===a&&2===J.settingsModel.design.color.selection&&c(function(){$("#widget_container").css("background-image",J.forecastBgValues[6])},30)},!1),b.$watch(function(){return J.settingsModel.design.animation},function(b){0===b&&e.getViewMode()!==i.PREVIEW_MODE&&c(function(){a.$broadcast(h.premium_notification_hide)},30)},!1),b.$watch(function(){return J.settingsModel.language},function(a,b){a!==b&&(J.filterDate=o("epochToFullDate")(J.weatherData.time_epoch,J.weatherData.short_day,J.weatherData.short_month,J.settingsModel.language))},!1)}function E(){J.isFallbackApplied&&(J.oldDesign&&0!==J.settingsModel.design.animation&&(J.oldDesign.tmpAnimation=J.settingsModel.design.animation),0!==J.settingsModel.design.animation&&(J.settingsModel.design.animation=0))}function F(){return(e.getViewMode()===i.SITE_MODE||e.getViewMode()===i.PREVIEW_MODE)&&!J.settingsModel.isPremium}function G(){e.getViewMode()==i.PREVIEW_MODE&&(J.viewMode=e.getViewMode(),J.isFallbackApplied=F(),J.isFallbackApplied&&(E(),0===J.oldDesign.tmpAnimation||J.settingsModel.isPremium||(a.showNotificationPremium=!0)))}function H(){D(),E(),w(),G(),e.applicationLoaded(),r(J.settingsModel.design.color.selection),s().then(function(a){J.forecastBgValues=a})}function I(a){return l.getSelectedSets(a)}var J=this;b.settings=d.settings,J.settingsModel=d.settings,J.weatherData=d.weather,J.settingsModel.isPremium=e.isPremium(),J.assets=I(J.settingsModel),J.isFallbackApplied=F(),J.forecast_classes=["forecast_default","forecast_website","forecast_colorful"],J.showNotification=!1,J.delegates={settingUpdateHandler:u,editorModeChange:v},J.viewMode=e.getViewMode(),J.oldDesign={tmpAnimation:0},J.filterDate=o("epochToFullDate")(J.weatherData.time_epoch,J.weatherData.short_day,J.weatherData.short_month,J.settingsModel.language),H(),J.inputFocusEvent=function(a){13===a.which&&($("#temp_toggle").attr("checked",!$("#temp_toggle").attr("checked")),J.settingsModel.tempUnit="c"==J.settingsModel.tempUnit?"f":"c")}}angular.module("weatherApp.widget").controller("LayoutCtrl",["$rootScope","$scope","$timeout","resolveData","WixService","WixBIService","WeatherService","Events","Constants","PremiumService","DemoModeService","StaticFilesManager","ColorService","$translate","$filter","$q","SettingsService",a])}(),function(){function a(a,b,c,d,e,f){function g(g){function h(){return g.windowWidth>d.LAYOUT_BRK_POINT&&m<=d.LAYOUT_BRK_POINT||g.windowWidth<=d.LAYOUT_BRK_POINT&&m>d.LAYOUT_BRK_POINT}function i(){var a=_.debounce(function(){g.$apply()},50);k.bind("resize",a)}function j(){i()}var k=angular.element(a),l=angular.element("body"),m=300;g.getWindowDimensions=function(){return{h:k.height(),w:k.width()}};var n=null;g.$watch(g.getWindowDimensions,function(a){g.windowHeight=a.h,g.windowWidth=a.w;var i={height:l.height()};g.windowWidth>d.LAYOUT_BRK_POINT&&m<=d.LAYOUT_BRK_POINT&&g.windowHeight>=i.height&&(n=f(function(){e.resizeComponent(i)},800)),h()&&b.$broadcast(c.layout_change),m=g.windowWidth},!0),j()}return{link:g}}angular.module("weatherApp.widget").directive("waResize",["$window","$rootScope","Events","Constants","WixService","$timeout",a])}(),function(){function a(a,b){function c(c,d,e){function f(){k(),l(),m()}function g(){d.css("background-image","")}function h(){return angular.element(window).width()>b.LAYOUT_BRK_POINT?"h":"v"}function i(a){var b=c.assets.types[c.weather.mapping.image[c.weather.dayTime]].url.split(".");return c.assets.base+b[0]+"_"+a+"."+b[1]}function j(){var a=h();0!==c.model&&d.css("background-image","url("+i(a)+")")}function k(){c.$watch("model",function(a,b){a!==b&&(0===a?g():j())},!1)}function l(){c.$watch("weather.condition",function(){j()},!1),c.$watch("weather.dayTime",function(){j()},!1)}function m(){c.$on(a.layout_change,j)}function n(){f()}n()}return{restrict:"A",link:c,scope:{model:"=waDataModel",weather:"=waWeatherModel",assets:"=waAssets"}}}angular.module("weatherApp.widget").directive("waBgImage",["Events","Constants",a])}(),function(){function a(){function a(a,b,c){function d(){}d()}return{restrict:"EA",replace:!0,link:a,templateUrl:"views/partials/waIcon.tpl.html",scope:{model:"=model",assets:"=assets",dayTime:"=dayTime"}}}angular.module("weatherApp.widget").directive("waIcon",[a])}(),function(){function a(){function a(a,b,c){function d(){a.$watch("dayTime",function(){}),a.$watch("config",function(a,b){b!==a&&g()}),a.$watch("animationSet",function(a,b){b!==a&&g()})}function e(){var a=b.attr("class").match(/\w+_+\d/);a=a?a[0]:"",b.removeClass(a)}function f(){if(a.config){var c=a.config[a.dayTime]+"_"+a.animationSet;b.addClass(c),a.currentAnimation=c}}function g(){e(),f()}function h(){a.$watch("applyAnimation",function(a,b){a&&(d(),g())})}a.star_1_length=new Array(50),a.star_2_length=new Array(100),h()}return{restrict:"EA",replace:!0,link:a,templateUrl:"views/partials/waAnimation.tpl.html",scope:{config:"=config",dayTime:"=dayTime",animationSet:"=animationSet",applyAnimation:"=applyAnimation"}}}angular.module("weatherApp.widget").directive("waAnimation",[a])}(),function(){function a(){function a(a,b,c){function d(){a.$watch("model",function(a,c){c!==a&&(b.hasClass(f)&&b.removeClass(f),b.addClass(f))})}function e(){d()}var f="fade_in";e()}return{restrict:"A",link:a,scope:{model:"=waFade"}}}angular.module("weatherApp.widget").directive("waFade",[a])}(),function(){angular.module("weatherApp.core",["ui.router","LocalStorageModule"]).constant("RESTApi",{url:"/api",ENV:"dev"}).constant("Constants",{LAYOUT_BRK_POINT:451,PREVIEW_MODE:"preview",EDITOR_MODE:"editor",SITE_MODE:"site",DEV_MODE:"weather.wixapps.codev.co.il"}).constant("Events",{setting_update:Wix.Events.SETTINGS_UPDATED,edit_mode_change:Wix.Events.EDIT_MODE_CHANGE,site_published:Wix.Events.SITE_PUBLISHED,site_saved:Wix.Events.SITE_SAVED,premium_notification_show:"PREMIUM_NOTIFICATION_SHOW",premium_notification_hide:"PREMIUM_NOTIFICATION_HIDE",layout_change:"LAYOUT_CHANGE",component_deleted:Wix.Events.COMPONENT_DELETED}).config(["localStorageServiceProvider",function(a){a.setPrefix("wa").setStorageType("sessionStorage")}])}(),function(){function a(a,b){function c(a){if(!a)throw new ReferenceError(g+"oData object must be provided");if(!angular.isObject(a))throw new TypeError(g+"oData's must be an object.")}function d(){return a({method:"GET",url:b.url+h}).then(function(a){return a.data})}function e(d){return c(d),a({method:"PUT",url:b.url+h,data:d})}function f(){return a({method:"DELETE",url:b.url+h})}var g="SettingsService : ",h="/settings";return{get:d,put:e,delete:f}}angular.module("weatherApp.core").factory("SettingsService",["$http","RESTApi",a])}(),function(){function a(a,b,c,d){function e(a){if(!a)throw new ReferenceError(P+"oData object must be provided");if(!angular.isObject(a))throw new TypeError(P+"oData's must be an object.")}function f(){var c=a.defer();return b(function(){$(function(){Wix.UI.initialize(),c.resolve()})},20),c.promise}function g(a){return b(function(){$(function(){Wix.UI.set("lang",a),h()})},20)}function h(){var a=function(){$(".dpLanguages div.selected div").remove("span"),$(".dpLanguages div.selected div").text($(".dpLanguages div.options.uilib-scrollbar .option.option-selected").text())};a(),$(".dpLanguages div.options.uilib-scrollbar").off("click",a),$(".dpLanguages div.options.uilib-scrollbar").on("click",a)}function i(){var b=a.defer();return Wix.Settings.getSiteInfo(function(a){if(!a)return b.reject();for(var c,d=a.url.split("?")[1].split("&"),e={},f=0;f<d.length;f++)c=d[f].split("="),e[c[0]]=c[1];b.resolve(e)}),b.promise}function j(b){var c=a.defer();return"editor"===F()?Wix.resizeComponent(b,function(a){c.resolve(a[0])}):c.reject("resizeComponent Can be used only in editor mode!"),c.promise}function k(){return Wix.Utils.getDeviceType()}function l(){return Wix.Utils.getOrigCompId()||Wix.Utils.getCompId()}function m(){function a(){var a={};return window.location.search.substr(1).split("&").forEach(function(b){b=b.split("="),a[b[0]]=b[1]}),a.compId}return Wix.Utils.getOrigCompId()||a()}function n(){return Wix.Utils.getInstanceId()}function o(a){return Wix.Utils.getInstanceValue(a)}function p(){return Wix.Utils.getLocale()}function q(a){switch(a){case"cs":a=0;break;case"da":a=1;break;case"de":a=2;break;case"en":a=3;break;case"es":a=4;break;case"fr":a=5;break;case"it":a=6;break;case"ja":a=7;break;case"ko":a=8;break;case"nl":a=9;break;case"no":a=10;break;case"pl":a=11;break;case"pt":a=12;break;case"ru":a=13;break;case"sv":a=14;break;case"tr":a=15}return a}function r(a){var b=p(),c=Number(a);switch(c){case 0:b="cs";break;case 1:b="da";break;case 2:b="de";break;case 3:b="en";break;case 4:b="es";break;case 5:b="fr";break;case 6:b="it";break;case 7:b="ja";break;case 8:b="ko";break;case 9:b="nl";break;case 10:b="no";break;case 11:b="pl";break;case 12:b="pt";break;case 13:b="ru";break;case 14:b="sv";break;case 15:b="tr"}return b}function s(){var b=a.defer();return Wix.Activities.getUserSessionToken(function(a){b.resolve(a)}),b.promise}function t(){var b=a.defer();return Wix.Styles.getStyleParams(function(a){b.resolve(a)}),b.promise}function u(){var b=a.defer();return Wix.Styles.getSiteColors(function(a){b.resolve(a)}),b.promise}function v(a){var b={websiteColorOpacity:{reference:"color-8"}};return u().then(function(c){return _.find(c,b[a]).value})}function w(a){var b;return t().then(function(c){switch(a){case 0:b=c.numbers.defaultColorOpacity?c.numbers.defaultColorOpacity/100:1;break;case 1:b=c.colors.websiteColorOpacity?c.colors.websiteColorOpacity.value:1,b="string"==typeof b&&b.indexOf("rgb")>-1?b.split(/[()]/)[1].split(",")[3].replace(" ",""):1;break;case 2:b=c.numbers.colorfulSetOpacity?c.numbers.colorfulSetOpacity/100:1}return b})}function x(a){var b=$('[wix-param="websiteColorOpacity"]').getCtrl();b.setOpacity(a),b.triggerChangeEvent({color:b.getPlugins().colorPicker.getColorObject(),opacity:b.getPlugins().slider.getValue()/100,rgba:b.getValue()}),Wix.Styles.setNumberParam("colorfulSetOpacity",{value:a}),Wix.Styles.setNumberParam("defaultColorOpacity",{value:a})}function y(b){var d;return a.all([t(),v("websiteColorOpacity")]).then(function(a){var e=a[0],f=a[1];switch(b){case 0:d="#3798eb";break;case 1:if(d=e.colors.websiteColorOpacity?e.colors.websiteColorOpacity.value:f,d.indexOf("rgba")<0&&d.indexOf("#")>-1){var g=c.hex2Rgb(d);g=g.split(/[()]/)[1].split(","),d="rgba("+g[0]+","+g[1]+","+g[2]+",1)"}d=c.rgb2Hex(d)}return d})}function z(){var a={};return window.location.search.substr(1).split("&").forEach(function(b){b=b.split("="),a[b[0]]=b[1]}),a}function A(){Wix.Settings.refreshAppByCompIds([m()])}function B(a){Wix.setHeight(a)}function C(a){e(a),b(function(){Wix.Settings.triggerSettingsUpdatedEvent(a,m())},40)}function D(a,b){Wix.addEventListener(a,b)}function E(a){b(function(){R||$(".color_row .uilib-color-box").on("click",function(){R||(b(function(){$(".simple-color-node").on("click",a),$(".uilib-popup").find(".popup-footer").find("button.close-popup").on("click",a),$(".uilib-color-box").find("button").on("click",function(){a(!0),$(".simple-color-node").unbind("click",a),$(".uilib-popup").find(".popup-footer").find("button.close-popup").unbind("click",a)}),R=!1},50),R=!0)})},100)}function F(){return Wix.Utils.getViewMode()}function G(){Wix.Settings.openBillingPage()}function H(){Wix.Preview.openSettingsDialog()}function I(){Wix.Settings.openReviewInfo()}function J(){var a=z().instance,b=JSON.parse(atob(a.split(".")[1]));return!(!b||!b.vendorProductId||null===b.vendorProductId)}function K(){if(!Q)return Q=!0,Wix.Performance.applicationLoaded()}function L(a,b,c,d,e){Wix.Settings.openModal(a,b,c,d,e)}function M(a,b){b=b||"",Wix.Performance.applicationLoadingStep(a,b)}function N(a,b,c,d,e){Wix.openModal(a,b,c,d,e)}function O(a){return _.find(d.getFonts(),{value:a}).text}var P="WixService : ",Q=!1,R=!1;return{init:f,initLangPicker:g,getSiteInfo:i,getDeviceType:k,getCompId:l,getOrigCompId:m,getInstanceId:n,getInstanceValue:o,getLocale:p,getCurrentLangByIndex:r,getCurrentLangIndex:q,getUserSession:s,getStyleParams:t,parseIFrameUrl:z,refreshWidget:A,setHeight:B,getViewMode:F,openBillingPage:G,openSettingsDialog:H,openReviewInfo:I,isPremium:J,getDefaultColor:v,getSelectedSetColor:y,setSelectedSetOpacity:x,getSelectedSetOpacity:w,triggerSettingUpdateEvent:C,addEventListener:D,registerPalletListener:E,resizeComponent:j,getSiteColors:u,applicationLoaded:K,openModal:N,openSettingsModal:L,getFontText:O,applicationLoadingStep:M}}angular.module("weatherApp.core").factory("WixService",["$q","$timeout","ColorService","BackwardCompatibilityService",a])}(),function(){function a(){function a(){if(navigator.userAgent.indexOf("MSIE")>-1||window.ActiveXObject||"ActiveXObject"in window)return"explorer"}function b(){if("undefined"!=typeof InstallTrigger)return"firefox"}function c(){if(navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")==-1&&navigator.userAgent.indexOf("Android")==-1)return"safari"}function d(){var d;return(d=a())?d:(d=b())?d:(d=c())?d:"chrome"}return{getClientBrowser:d,isSafari:c}}angular.module("weatherApp.core").factory("BrowserDetection",[a])}(),function(){function a(a){function b(){return a.parseIFrameUrl()}return{request:function(c){var d;try{d=b(),c.headers["x-wix-comp-id"]=a.getCompId(),c.headers["x-wix-instance-id"]=d.instance,c.headers["x-wix-locale"]=a.getLocale()}catch(e){}return c}}}angular.module("weatherApp.core").factory("RequestInterceptor",["WixService",a])}(),function(){function a(a){function b(){return a.isPremium()}function c(a,b){var c=a.data||a;return b.design.animation!==c.design.animation&&0!=c.design.animation}function d(a,b){var c=!1;switch(a){case"animation":c=0!=b}return c}return{isPremium:b,isPremiumItemsSelected:c,isPremiumItemSelected:d}}angular.module("weatherApp.core").factory("PremiumService",["WixService",a])}(),function(){function a(a){function b(a,b){var c=Object.keys(g);if(c.indexOf(a)<0)throw new TypeError(j+"type is invalid");var d=g[a][h].length;if(b>d)throw new TypeError(j+"idx is invalid");return!0}function c(){return a({method:"GET",url:"../assets/maps/json_sets.json"}).then(function(a){if(a&&a.data)return g=a.data;throw{msg:"error loading json map sets",code:404}}).catch(function(a){console.error(a)})}function d(a,c){return a=a.toLowerCase()||i,b(a,c),c?g[a][h][c]:g[a][h]}function e(a){return{backgrounds:g.backgrounds.sets[a.design.backgroundSet],icons:g.icons.sets[a.design.iconSet],animations:g.animations.sets[a.design.animation]}}function f(){function a(a){for(var b=[],c=0;c<a.length;c++)b[c]=new Image,b[c].src=a[c]}if(g){var b=[];g.backgrounds.sets.forEach(function(a,c){if(a.hasOwnProperty("base"))for(var d in a.types){var e=a.types[d].url.split(".");b.push(a.base+e[0]+"_v."+e[1]),b.push(a.base+e[0]+"_h."+e[1])}}),a(b)}}var g,h="sets",i="clear",j="StaticFilesManager: ";return{load:c,getData:d,getSelectedSets:e,preLoadImages:f}}angular.module("weatherApp.core").factory("StaticFilesManager",["$http",a]).run(["StaticFilesManager","WixService","ME",function(a,b,c){a.load().then(function(){"widget"===c&&"editor"===b.getViewMode()&&a.preLoadImages()})}])}(),function(){function a(a,b){function c(c,d){return a({method:"GET",url:b.url+"/weather",params:{filter:c,lang:d}}).then(function(a){return a.data.payload||{}})}function d(c){return a({method:"GET",url:b.url+"/weather/mapping/"+c}).then(function(a){return{mapping:a.data.payload}})}return{get:c,getMapping:d}}angular.module("weatherApp.core").factory("WeatherService",["$http","RESTApi",a])}(),function(){function a(a){function b(a){return a.indexOf("rgba")>-1}function c(a,b,c){return["rgb(",a,",",b,",",c,")"].join("")}function d(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null}function e(a,b){return b=b||1,a=a.replace(/rgb/,"rgba"),[a.slice(0,a.length-1),",",b,")"].join("")}function f(b,c){var d={explorer:"ms",firefox:"moz",fallback:"webkit"},e=d[a.getClientBrowser()]?d[a.getClientBrowser()]:d.fallback,f=parseFloat(b.opacity);b.rgba.start=b.rgba.start.r+","+b.rgba.start.g+","+b.rgba.start.b,b.rgba.end=b.rgba.end.r+","+b.rgba.end.g+","+b.rgba.end.b;var g="rgba("+b.rgba.start+","+f+")",h="rgba("+b.rgba.end+","+f+")";return["-",e,"-linear-gradient(top,",g,",",h,")"].join("")}function g(a,b){a=String(a).replace(/[^0-9a-f]/gi,""),a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),b=b||0;var c,d,e="#";for(d=0;d<3;d++)c=parseInt(a.substr(2*d,2),16),c=Math.round(Math.min(Math.max(0,c+c*b),255)).toString(16),e+=("00"+c).substr(c.length);return e}function h(a,b,c,d){var h;switch(c){case 0:h=g(a,l*d),h=e(j(h),b);break;case 1:h=g(a,l*d),h=e(j(h),b);break;case 2:var i={rgba:_.clone(m[d]),opacity:b};h=f(i,d)}return h}function i(a){return a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i),a&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):""}function j(a){var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return b?c(parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)):null}function k(a){return b(a)?a.substr(0,a.lastIndexOf(",")+1)+"1)":a}var l=.05,m=[{start:d("#ff9500"),end:d("#ff5e3a")},{start:d("#ffdb4c"),end:d("#ffcd02")},{start:d("#87fc70"),end:d("#0bd318")},{start:d("#1ad6fd"),end:d("#1d62f0")},{start:d("#c544fc"),end:d("#6c44fc")},{start:d("#ef4db6"),end:d("#c643fb")},{start:d("#3798eb"),end:d("#3798eb")}];return{rgb2Hex:i,hex2Rgb:j,buildRgb:c,rgb2Rgba:e,buildCustomBg:k,buildForecastBg:h}}angular.module("weatherApp.core").factory("ColorService",["BrowserDetection",a])}(),function(){function a(a){function b(b,d){a.debug("mixpanel: ",b,d),c.track(b,d)}var c=window.mixpanel,d=this;angular.extend(d,{triggerEvent:b})}angular.module("weatherApp.core").service("eventStrategies.mixpanel",["$log",a])}(),function(){function a(a){function b(b){var c={src:"63",biToken:d,app_id:"13ee112c-7aca-8530-909b-ca5fd7039bf8",app_site_id:a.getInstanceId(),instance_id:a.getCompId()};return _.assign(c,b),c}function c(c){var d="";"site"==a.getViewMode()&&(d="https://frog.wix.com/wixlabs-ugc"),"editor"==a.getViewMode()&&(d="https://frog.wix.com/wixlabs-users");var e=new Date,f=d+"?"+$.param(b(c))+"&"+e.getTime();$("<img/>").attr("src",f)}var d=a.getInstanceValue("biToken");return{triggerEvent:c}}angular.module("weatherApp.core").service("WixBIService",["WixService",a])}(),function(){function a(a,b,c){function d(){return[{text:"Ahmed Outline",value:"ahmedltw20-outlineregul"},{text:"Amiri",value:"amiri"},{text:"Arabic Typesetting Regular",value:"arabictypesettingw23-re"},{text:"Arial",value:"arial"},{text:"Arian",value:"arian-lt-w20-regular"},{text:"Arian Light",value:"arian-lt-w20-light"},{text:"Courier New",value:"courier new"},{text:"DIN Next Arabic",value:"dinnextltw23-ultralight"},{text:"Droid Naskh",value:"droid-naskh"},{text:"Janna",value:"janna-lt-w20-regular"},{text:"Kufi Regular",value:"kufi-lt-w20-regular"},{text:"Midan",value:"midan-w20"},{text:"Neue Helvetica Arabic",value:"helveticaneueltw20-ligh"},{text:"Tahoma",value:"tahoma"},{text:"Tanseek Modern Light",value:"tanseekmodernw20-light"},{text:"Times New Roman",value:"times new roman"},{text:"Adler",value:"adler-w26-regular"},{text:"Alef",value:"alef-regular"},{text:"Almoni DL Bold",value:"almoni-dl-aaa-700"},{text:"Almoni DL Light",value:"almoni-dl-aaa-300"},{text:"Almoni DL Regular",value:"almoni-dl-aaa-400"},{text:"Asimon",value:"asimon-aaa-400"},{text:"Atlas",value:"atlas-aaa-500"},{text:"Chips",value:"chips-w26-normal"},{text:"Frank Ruhl",value:"frank-ruhl-w26-regular"},{text:"Gulash",value:"gulash-w26-regular"},{text:"Longlife",value:"haim-arukeem-w26-medium"},{text:"Miriam",value:"miriam-w26-medium"},{text:"Mixtape",value:"mixtape-aaa-400"},{text:"Museum",value:"museum-aaa-400"},{text:"Nekudot Bold",value:"nekudot-w26-bold"},{text:"Omes",value:"omes-aaa-400"},{text:"Open Sans Condensed",value:"opensanshebrewcondensed-regular"},{text:"Shabazi Bold",value:"shabazi-w26-bold"},{text:"Adobe Caslon",value:"adobe-caslon-w01-smbd"},{text:"Amatic SC",value:"amatic sc"},{text:"American Typewriter",value:"americantypwrteritcw01--731025"},{text:"Anton",value:"anton"},{text:"Arial Black",value:"arial black"},{text:"Avenida",value:"avenida-w01"},{text:"Avenir",value:"avenir-lt-w01_85-heavy1475544"},{text:"Avenir Light",value:"avenir-lt-w01_35-light1475496"},{text:"Basic",value:"basic"},{text:"Belinda",value:"belinda-w00-regular"},{text:"Bodoni Poster",value:"bodoni-w01-poster"},{text:"Braggadocio",value:"braggadocio-w01"},{text:"Brandon Grotesque",value:"brandon-grot-w01-light"},{text:"Bree",value:"bree-w01-thin-oblique"},{text:"Caudex",value:"caudex"},{text:"Chelsea Market",value:"chelsea market"},{text:"Cinzel",value:"cinzel"},{text:"Clarendon LT",value:"clarendon-w01-medium-692107"},{text:"Comic Sans MS",value:"comic sans ms"},{text:"Cookie",value:"cookie"},{text:"Coquette",value:"coquette-w00-light"},{text:"Corben",value:"corben"},{text:"DIN Neuzeit Grotesk",value:"dinneuzeitgroteskltw01-_812426"},{text:"DIN Next Light",value:"din-next-w01-light"},{text:"Droid Serif",value:"droid-serif-w01-regular"},{text:"EB Garamond",value:"eb garamond"},{text:"Enriqueta",value:"enriqueta"},{text:"Forum",value:"forum"},{text:"Fredericka the Great",value:"fredericka the great"},{text:"Futura",value:"futura-lt-w01-book"},{text:"Futura Light",value:"futura-lt-w01-light"},{text:"Georgia",value:"georgia"},{text:"Geotica Four Open",value:"geotica-w01-four-open"},{text:"Helvetica",value:"helvetica-w01-roman"},{text:"Helvetica Bold",value:"helvetica-w01-bold"},{text:"Helvetica Light",value:"helvetica-w01-light"},{text:"ITC Arecibo",value:"itc-arecibo-w01-regular"},{text:"Impact",value:"impact"},{text:"Jockey One",value:"jockey one"},{text:"Josefin Slab",value:"josefin slab"},{text:"Jura",value:"jura"},{text:"Kelly Slab",value:"kelly slab"},{text:"Kepler",value:"kepler-w03-light-scd-cp"},{text:"Libre Baskerville",value:"libre baskerville"},{text:"Linotype Didot",value:"didot-w01-italic"},{text:"Lobster",value:"lobster"},{text:"Lucida Console",value:"lucida console"},{text:"Lucida Sans Unicode",value:"lucida sans unicode"},{text:"Lulo Clean",value:"lulo-clean-w01-one-bold"},{text:"Marck Script",value:"marck script"},{text:"Marzo",value:"marzo-w00-regular"},{text:"Monoton",value:"monoton"},{text:"Monotype Baskerville",value:"baskervillemtw01-smbdit"},{text:"Mr De Haviland",value:"mr de haviland"},{text:"Museo",value:"museo-w01-700"},{text:"Museo Slab",value:"museo-slab-w01-100"},{text:"Niconne",value:"niconne"},{text:"Nimbus Sans",value:"nimbus-sans-tw01con"},{text:"Noticia Text",value:"noticia text"},{text:"Open Sans",value:"open sans"},{text:"Overlock",value:"overlock"},{text:"Pacifica Condensed",value:"pacifica-w00-condensed"},{text:"Palatino Linotype",value:"palatino linotype"},{text:"Patrick Hand",value:"patrick hand"},{text:"Peaches & Cream",value:"peaches-and-cream-regular-w00"},{text:"Play",value:"play"},{text:"Playfair Display",value:"playfair display"},{text:"Proxima Nova",value:"proxima-n-w01-reg"},{text:"Raleway",value:"raleway"},{text:"Reklame Script",value:"reklamescriptw00-medium"},{text:"Rosewood",value:"rosewood-w01-regular"},{text:"Sacramento",value:"sacramento"},{text:"Sail",value:"sail"},{text:"Sarina",value:"sarina"},{text:"Signika",value:"signika"},{text:"Snell Roundhand",value:"snellroundhandw01-scrip"},{text:"Soho Condensed",value:"soho-w01-thin-condensed"},{text:"Spinnaker",value:"spinnaker"},{text:"Stencil",value:"stencil-w01-bold"},{text:"Trend",value:"trend-sans-w00-four"},{text:"Verdana",value:"verdana"}]}return{getFonts:d}}angular.module("weatherApp.core").factory("BackwardCompatibilityService",[a])}(),function(){function a(a,b,c,d,e,f){function g(g,h,i){function j(){"editor"==d.getViewMode()&&(a.cancel(n),$(h).addClass("show"),n=a(function(){k()},o)),"preview"==d.getViewMode()&&$(h).addClass("show")}function k(){$(h).removeClass("show"),a.cancel(n)}function l(){m(),f.showNotificationPremium&&(k(),j(),f.showNotificationPremium=!1)}function m(){f.$on(c.premium_notification_show,j),f.$on(c.premium_notification_hide,k)}var n,o=1e3*g.timeInSec,p="isPremiumPopup";l(),g.upgradeHandler=function(){b.set(p,!0),a(function(){d.openSettingsDialog()},200)},g.triggerEvent=function(){if("preview"==g.tplType){var a={market:"",origin:"preview",sub_origin:"notification",tab_name:"none",evid:12};e.triggerEvent(a)}}}return{restrict:"EA",replace:!0,scope:{timeInSec:"@timeInSec",tplType:"@tplType"},templateUrl:function(a,b){return"../core/directives/templates/"+b.tplType+"/waPremiumNotification.tpl.html"},link:g}}angular.module("weatherApp.core").directive("waPremiumNotification",["$timeout","localStorageService","Events","WixService","WixBIService","$rootScope",a]);
}();